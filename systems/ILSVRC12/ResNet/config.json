{
    "data": {
        "train": {
            "dataset": {
                "transform": {
                    "class": "TransformA",
                    "kwargs": {
                        "augment": true
                    }
                }
            },
            "dataloader": {
                "bs": 128
            }
        },
        "valid": {
            "dataset": {
                "transform": {
                    "class": "TransformA",
                    "kwargs": {
                        "augment": false
                    }
                }
            },
            "dataloader": {
                "bs": 128
            }
        }
    },
    "network": {
        "class": "ResNet",
        "kwargs": {
            "config": "ResNet18"
        },
        "quantize": {
            "function": "all_ana_recipe",
            "kwargs": {
                "quantizer_spec_conv": {
                    "nbits": 4,
                    "signed": true,
                    "balanced": false,
                    "eps": 0.07
                },
                "quantizer_spec_act": {
                    "nbits": 4,
                    "signed": false,
                    "balanced": false,
                    "eps": 0.07
                },
                "noise_type": "uniform",
                "strategy": "mode"
            }
        }
    },
    "training": {
        "loss_fn": {
            "class": "CrossEntropyLoss",
            "kwargs": {}
        },
        "gd": {
            "opt": {
                "class": "Adam",
                "kwargs": {
                    "lr": 0.01
                }
            },
            "lr_sched": {
                "class": "HandScheduler",
                "kwargs": {
                    "schedule": {
                        "400": 0.1
                    }
                }
            }
        },
        "n_epochs": 100,
        "quantize": {
            "function": "all_ana_controller",
            "kwargs": {
                "ctrl_spec": [
                    {
                        "modules": [
                            "pilot.0", "pilot.2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.0.0.conv1", "features.0.0.relu1",
                            "features.0.0.conv2", "features.0.0.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.0.1.conv1", "features.0.1.relu1",
                            "features.0.1.conv2", "features.0.1.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.1.0.downsample.conv", "features.1.0.downsample.bn.1",
                            "features.1.0.conv1", "features.1.0.relu1",
                            "features.1.0.conv2", "features.1.0.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.1.1.conv1", "features.1.1.relu1",
                            "features.1.1.conv2", "features.1.1.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.2.0.downsample.conv", "features.2.0.downsample.bn.1",
                            "features.2.0.conv1", "features.2.0.relu1",
                            "features.2.0.conv2", "features.2.0.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.2.1.conv1", "features.2.1.relu1",
                            "features.2.1.conv2", "features.2.1.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.3.0.downsample.conv", "features.3.0.downsample.bn.1",
                            "features.3.0.conv1", "features.3.0.relu1",
                            "features.3.0.conv2", "features.3.0.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    },
                    {
                        "modules": [
                            "features.3.1.conv1", "features.3.1.relu1",
                            "features.3.1.conv2", "features.3.1.relu2"
                        ],
                        "mi": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        },
                        "sigma": {
                            "beta": 0.0,
                            "fun": "bws",
                            "kwargs": {"tstart": 0, "tend": 100, "alpha": 0}
                        }
                    }
                ]
            }
        }
    },
    "meters": {
        "train": {
            "compute_profiling_statistic": true,
            "compute_task_statistic": true
        },
        "valid": {
            "compute_profiling_statistic": true
        }
    }
}
